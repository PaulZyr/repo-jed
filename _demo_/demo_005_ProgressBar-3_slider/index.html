<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <title>ProgressBar-3_slider</title>

  <style>
    * {
      box-sizing: border-box;
    }
    h1{text-align: center;}
    .box {
      width: 70%;
      margin: 50px auto;
      outline: 2px dotted green;
      outline-offset: 14px;
    }

    .box-line {
      height: 6px;
      background: #ddd;
      margin: 0 0 20px;
    }

    .box-progress {
      width: 0;
      height: 2px;
      background: red;
      float: left;
      margin-top: 2px;
    }

    .slide-img {
      display: block;
      /* width: 200px;
    height: 101px; */
      background: gold;
    }

    .img-l {
      float: left;
      margin: 0 16px 16px;
    }

    .img-r {
      float: right;
      margin: 0 16px 16px;
    }

    cite {
      text-transform: capitalize;
      color: blue;
    }

    .slides {
      position: relative;
      overflow: hidden;
      height: 300px;
    }

    .slide {
      position: absolute;
      top: 0;
      left: 0;right: 0;
      opacity: 0;
      height: 0;
      overflow: hidden;
    }

    .slide.active {
      opacity: 1;
      height: 100%;
    }
  </style>
</head>

<body>
  <h1>ProgressBar-3 Slider</h1>
  <div class="box">
    <div class="box-line"><span class="box-progress" id="progress" style="awidth: 21%;"></span></div>

    <div class="slides">
      <div class="slide">
        <img class="slide-img img-r" src="https://placeimg.com/300/150/any" alt="descr">
        <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Architecto dolorem animi obcaecati quaerat enim inventore repellat iusto possimus modi dolor.</p>
        <cite>&mdash; 1 pino caruso</cite>
      </div>
      <div class="slide active">
        <img class="slide-img img-r" src="https://placeimg.com/300/200/any" alt="descr">
        <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Architecto dolorem animi obcaecati quaerat enim inventore repellat iusto possimus modi dolor.</p>
        <cite>&mdash; 2 pino via caruso</cite>
      </div>
      <div class="slide">
        <img class="slide-img img-l" src="https://placeimg.com/200/300/any" alt="descr">
        <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Architecto dolorem animi obcaecati quaerat enim inventore repellat iusto possimus modi dolor.</p>
        <cite>&mdash; 3 pino caruso</cite>
      </div>
    </div>
  </div>


  <script>
    "use strict"

    /* progress bar */
    var bar = document.getElementById("progress");
    var progress = 0;

    setTimeout(function() {
      bar.style.width = 100 + '%';
      bar.style.transition = 'all 3000ms linear';
    }, 40);
    /* slider  */
    var current = document.querySelector(".active");

    var timer = setInterval(function() {
      // Clear progress bar property by timeout every 40 ms(every 25-th  frame)
      if (progress == 75) { // 200 80 // 200 = 8000/40 ||  100 = 4000/40 || 75 = 3000/40
        setTimeout(function() {
          bar.style.width = 0;
          bar.style.transition = 'unset';
        }, 40)

        // change slide
        if (current.nextElementSibling) {
          current.classList.remove("active");
          current.nextElementSibling.classList.add("active");
          current = current.nextElementSibling;
        } else {
          current.classList.remove("active");
          current.parentElement.firstElementChild.classList.add("active");
          current = current.parentElement.firstElementChild;
        }
        progress = 0;
        setTimeout(function() {
          bar.style.width = 100 + '%';
          bar.style.transition = 'all 3000ms linear';
        }, 50);
      }
      // bar.style.width = progress + '%';
      progress++;
    }, 40);
  </script>
</body>

</html>
